import{_ as p,r as t,o,c as r,a as n,b as s,d as e,e as c}from"./app-BcWTENpX.js";const l={},k=c(`<h2 id="webpack5-0ä¼˜åŒ–ç‚¹" tabindex="-1"><a class="header-anchor" href="#webpack5-0ä¼˜åŒ–ç‚¹"><span>webpack5.0ä¼˜åŒ–ç‚¹</span></a></h2><h2 id="hot-module-replacement-hmr" tabindex="-1"><a class="header-anchor" href="#hot-module-replacement-hmr"><span>Hot Module Replacement(HMR)</span></a></h2><p>ç¬¬ä¸€æ­¥ï¼Œåœ¨ webpack çš„ watch æ¨¡å¼ä¸‹ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­æŸä¸€ä¸ªæ–‡ä»¶å‘ç”Ÿä¿®æ”¹ï¼Œwebpack ç›‘å¬åˆ°æ–‡ä»¶å˜åŒ–ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶å¯¹æ¨¡å—é‡æ–°ç¼–è¯‘æ‰“åŒ…ï¼Œå¹¶å°†æ‰“åŒ…åçš„ä»£ç é€šè¿‡ç®€å•çš„ JavaScript å¯¹è±¡ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚ ç¬¬äºŒæ­¥æ˜¯ webpack-dev-server å’Œ webpack ä¹‹é—´çš„æ¥å£äº¤äº’ï¼Œè€Œåœ¨è¿™ä¸€æ­¥ï¼Œä¸»è¦æ˜¯ dev-server çš„ä¸­é—´ä»¶ webpack-dev-middleware å’Œ webpack ä¹‹é—´çš„äº¤äº’ï¼Œwebpack-dev-middleware è°ƒç”¨ webpack æš´éœ²çš„ APIå¯¹ä»£ç å˜åŒ–è¿›è¡Œç›‘æ§ï¼Œå¹¶ä¸”å‘Šè¯‰ webpackï¼Œå°†ä»£ç æ‰“åŒ…åˆ°å†…å­˜ä¸­ã€‚ ç¬¬ä¸‰æ­¥æ˜¯ webpack-dev-server å¯¹æ–‡ä»¶å˜åŒ–çš„ä¸€ä¸ªç›‘æ§ï¼Œè¿™ä¸€æ­¥ä¸åŒäºç¬¬ä¸€æ­¥ï¼Œå¹¶ä¸æ˜¯ç›‘æ§ä»£ç å˜åŒ–é‡æ–°æ‰“åŒ…ã€‚å½“æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®äº†devServer.watchContentBase ä¸º true çš„æ—¶å€™ï¼ŒServer ä¼šç›‘å¬è¿™äº›é…ç½®æ–‡ä»¶å¤¹ä¸­é™æ€æ–‡ä»¶çš„å˜åŒ–ï¼Œå˜åŒ–åä¼šé€šçŸ¥æµè§ˆå™¨ç«¯å¯¹åº”ç”¨è¿›è¡Œ live reloadã€‚æ³¨æ„ï¼Œè¿™å„¿æ˜¯æµè§ˆå™¨åˆ·æ–°ï¼Œå’Œ HMR æ˜¯ä¸¤ä¸ªæ¦‚å¿µã€‚ ç¬¬å››æ­¥ä¹Ÿæ˜¯ webpack-dev-server ä»£ç çš„å·¥ä½œï¼Œè¯¥æ­¥éª¤ä¸»è¦æ˜¯é€šè¿‡ sockjsï¼ˆwebpack-dev-server çš„ä¾èµ–ï¼‰åœ¨æµè§ˆå™¨ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´å»ºç«‹ä¸€ä¸ª websocket é•¿è¿æ¥ï¼Œå°† webpack ç¼–è¯‘æ‰“åŒ…çš„å„ä¸ªé˜¶æ®µçš„çŠ¶æ€ä¿¡æ¯å‘ŠçŸ¥æµè§ˆå™¨ç«¯ï¼ŒåŒæ—¶ä¹ŸåŒ…æ‹¬ç¬¬ä¸‰æ­¥ä¸­ Server ç›‘å¬é™æ€æ–‡ä»¶å˜åŒ–çš„ä¿¡æ¯ã€‚æµè§ˆå™¨ç«¯æ ¹æ®è¿™äº› socket æ¶ˆæ¯è¿›è¡Œä¸åŒçš„æ“ä½œã€‚å½“ç„¶æœåŠ¡ç«¯ä¼ é€’çš„æœ€ä¸»è¦ä¿¡æ¯è¿˜æ˜¯æ–°æ¨¡å—çš„ hash å€¼ï¼Œåé¢çš„æ­¥éª¤æ ¹æ®è¿™ä¸€ hash å€¼æ¥è¿›è¡Œæ¨¡å—çƒ­æ›¿æ¢ã€‚ webpack-dev-server/client ç«¯å¹¶ä¸èƒ½å¤Ÿè¯·æ±‚æ›´æ–°çš„ä»£ç ï¼Œä¹Ÿä¸ä¼šæ‰§è¡Œçƒ­æ›´æ¨¡å—æ“ä½œï¼Œè€ŒæŠŠè¿™äº›å·¥ä½œåˆäº¤å›ç»™äº† webpackï¼Œwebpack/hot/dev-server çš„å·¥ä½œå°±æ˜¯æ ¹æ® webpack-dev-server/client ä¼ ç»™å®ƒçš„ä¿¡æ¯ä»¥åŠ dev-server çš„é…ç½®å†³å®šæ˜¯åˆ·æ–°æµè§ˆå™¨å‘¢è¿˜æ˜¯è¿›è¡Œæ¨¡å—çƒ­æ›´æ–°ã€‚å½“ç„¶å¦‚æœä»…ä»…æ˜¯åˆ·æ–°æµè§ˆå™¨ï¼Œä¹Ÿå°±æ²¡æœ‰åé¢é‚£äº›æ­¥éª¤äº†ã€‚ HotModuleReplacement.runtime æ˜¯å®¢æˆ·ç«¯ HMR çš„ä¸­æ¢ï¼Œå®ƒæ¥æ”¶åˆ°ä¸Šä¸€æ­¥ä¼ é€’ç»™ä»–çš„æ–°æ¨¡å—çš„ hash å€¼ï¼Œå®ƒé€šè¿‡ JsonpMainTemplate.runtime å‘ server ç«¯å‘é€ Ajax è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å›ä¸€ä¸ª jsonï¼Œè¯¥ json åŒ…å«äº†æ‰€æœ‰è¦æ›´æ–°çš„æ¨¡å—çš„ hash å€¼ï¼Œè·å–åˆ°æ›´æ–°åˆ—è¡¨åï¼Œè¯¥æ¨¡å—å†æ¬¡é€šè¿‡ jsonp è¯·æ±‚ï¼Œè·å–åˆ°æœ€æ–°çš„æ¨¡å—ä»£ç ã€‚è¿™å°±æ˜¯ä¸Šå›¾ä¸­ 7ã€8ã€9 æ­¥éª¤ã€‚ è€Œç¬¬ 10 æ­¥æ˜¯å†³å®š HMR æˆåŠŸä¸å¦çš„å…³é”®æ­¥éª¤ï¼Œåœ¨è¯¥æ­¥éª¤ä¸­ï¼ŒHotModulePlugin å°†ä¼šå¯¹æ–°æ—§æ¨¡å—è¿›è¡Œå¯¹æ¯”ï¼Œå†³å®šæ˜¯å¦æ›´æ–°æ¨¡å—ï¼Œåœ¨å†³å®šæ›´æ–°æ¨¡å—åï¼Œæ£€æŸ¥æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæ›´æ–°æ¨¡å—çš„åŒæ—¶æ›´æ–°æ¨¡å—é—´çš„ä¾èµ–å¼•ç”¨ã€‚ æœ€åä¸€æ­¥ï¼Œå½“ HMR å¤±è´¥åï¼Œå›é€€åˆ° live reload æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œæµè§ˆå™¨åˆ·æ–°æ¥è·å–æœ€æ–°æ‰“åŒ…ä»£ç ã€‚ åœ¨åˆæ­¥ä½“ä¼šäº†webpackçš„çƒ­æ›´æ–°ä¹‹åï¼Œå¯èƒ½éœ€è¦æ€è€ƒä»¥ä¸‹çš„é—®é¢˜</p><h3 id="ä¸ºä»€ä¹ˆéœ€è¦çƒ­æ›´æ–°" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦çƒ­æ›´æ–°"><span>ä¸ºä»€ä¹ˆéœ€è¦çƒ­æ›´æ–°ï¼Ÿ</span></a></h3><p>Hot Module Replacementï¼ˆä»¥ä¸‹ç®€ç§° HMRï¼‰æ˜¯ webpack å‘å±•è‡³ä»Šå¼•å…¥çš„æœ€ä»¤äººå…´å¥‹çš„ç‰¹æ€§ä¹‹ä¸€ ï¼Œå½“ä½ å¯¹ä»£ç è¿›è¡Œä¿®æ”¹å¹¶ä¿å­˜åï¼Œwebpack å°†å¯¹ä»£ç é‡æ–°æ‰“åŒ…ï¼Œå¹¶å°†æ–°çš„æ¨¡å—å‘é€åˆ°æµè§ˆå™¨ç«¯ï¼Œæµè§ˆå™¨é€šè¿‡æ–°çš„æ¨¡å—æ›¿æ¢è€çš„æ¨¡å—ï¼Œè¿™æ ·åœ¨ä¸åˆ·æ–°æµè§ˆå™¨çš„å‰æä¸‹å°±èƒ½å¤Ÿå¯¹åº”ç”¨è¿›è¡Œæ›´æ–°ã€‚ä¾‹å¦‚ï¼Œåœ¨å¼€å‘ Web é¡µé¢è¿‡ç¨‹ä¸­ï¼Œå½“ä½ ç‚¹å‡»æŒ‰é’®ï¼Œå‡ºç°ä¸€ä¸ªå¼¹çª—çš„æ—¶å€™ï¼Œå‘ç°å¼¹çª—æ ‡é¢˜æ²¡æœ‰å¯¹é½ï¼Œè¿™æ—¶å€™ä½ ä¿®æ”¹ CSS æ ·å¼ï¼Œç„¶åä¿å­˜ï¼Œåœ¨æµè§ˆå™¨æ²¡æœ‰åˆ·æ–°çš„å‰æä¸‹ï¼Œæ ‡é¢˜æ ·å¼å‘ç”Ÿäº†æ”¹å˜ã€‚æ„Ÿè§‰å°±åƒåœ¨ Chrome çš„å¼€å‘è€…å·¥å…·ä¸­ç›´æ¥ä¿®æ”¹å…ƒç´ æ ·å¼ä¸€æ ·ã€‚</p><h3 id="hmræ˜¯æ€æ ·å®ç°è‡ªåŠ¨ç¼–è¯‘çš„" tabindex="-1"><a class="header-anchor" href="#hmræ˜¯æ€æ ·å®ç°è‡ªåŠ¨ç¼–è¯‘çš„"><span>HMRæ˜¯æ€æ ·å®ç°è‡ªåŠ¨ç¼–è¯‘çš„ï¼Ÿ</span></a></h3><p>webpacké€šè¿‡watchå¯ä»¥ç›‘å¬æ–‡ä»¶ç¼–è¯‘å®Œæˆå’Œç›‘å¬æ–‡ä»¶çš„å˜åŒ–ï¼Œwebpack-dev-middlewareå¯ä»¥è°ƒç”¨webpackçš„APIç›‘å¬ä»£ç çš„å˜åŒ–ï¼Œwebpack-dev-middlewareåˆ©ç”¨sockjså’Œwebpack-dev-server/clientå»ºç«‹webSocketé•¿è¿æ¥ã€‚å°†webpackçš„ç¼–è¯‘ç¼–è¯‘æ‰“åŒ…çš„å„ä¸ªé˜¶æ®µå‘Šè¯‰æµè§ˆå™¨ç«¯ã€‚ä¸»è¦å‘Šè¯‰æ–°æ¨¡å—hashçš„å˜åŒ–ï¼Œç„¶åwebpack-dev-server/clientæ˜¯æ— æ³•è·å–æ›´æ–°çš„ä»£ç çš„ï¼Œé€šè¿‡webpack/hot/serverè·å–æ›´æ–°çš„æ¨¡å—ï¼Œç„¶åHMRå¯¹æ¯”æ›´æ–°æ¨¡å—å’Œæ¨¡å—çš„ä¾èµ–ã€‚ æ€è€ƒğŸ’¡ï¼šæ¨¡å—å†…å®¹çš„å˜æ›´æµè§ˆå™¨åˆæ˜¯å¦‚ä½•æ„ŸçŸ¥çš„ï¼Ÿ webpack-dev-middlewareåˆ©ç”¨sockjså’Œwebpack-dev-server/clientå»ºç«‹webSocketé•¿è¿æ¥ã€‚å°†webpackçš„ç¼–è¯‘ç¼–è¯‘æ‰“åŒ…çš„å„ä¸ªé˜¶æ®µå‘Šè¯‰æµè§ˆå™¨ç«¯ã€‚ æ€è€ƒğŸ’¡ï¼šä»¥åŠæ–°äº§ç”Ÿçš„ä¸¤ä¸ªæ–‡ä»¶åˆæ˜¯å¹²å˜›çš„ï¼Ÿ d04feccfa446b174bc10.hot-update.json å‘ŠçŸ¥æµè§ˆå™¨æ–°çš„hashå€¼ï¼Œå¹¶ä¸”æ˜¯å“ªä¸ªchunkå‘ç”Ÿäº†æ”¹å˜ main.d04feccfa446b174bc10.hot-update.js å‘ŠçŸ¥æµè§ˆå™¨ï¼Œmain ä»£ç å—ä¸­çš„/src/title.jsæ¨¡å—å˜æ›´çš„å†…å®¹ é¦–å…ˆæ˜¯é€šè¿‡XMLHttpRequestçš„æ–¹å¼ï¼Œåˆ©ç”¨ä¸Šä¸€æ¬¡ä¿å­˜çš„hashå€¼è¯·æ±‚hot-update.jsonæ–‡ä»¶ã€‚è¿™ä¸ªæè¿°æ–‡ä»¶çš„ä½œç”¨å°±æ˜¯æä¾›äº†ä¿®æ”¹çš„æ–‡ä»¶æ‰€åœ¨çš„chunkIdã€‚ ç„¶åé€šè¿‡JSONPçš„æ–¹å¼ï¼Œåˆ©ç”¨hot-update.jsonè¿”å›çš„chunkId åŠ ä¸Šä¸€æ¬¡ä¿å­˜çš„hash æ‹¼æ¥æ–‡ä»¶åè¿›è€Œè·å–æ–‡ä»¶å†…å®¹ã€‚ æ€è€ƒğŸ’¡ï¼šæ€ä¹ˆå®ç°å±€éƒ¨æ›´æ–°çš„ï¼Ÿ å½“hot-update.jsæ–‡ä»¶åŠ è½½å¥½åï¼Œå°±ä¼šæ‰§è¡Œwindow.webpackHotUpdateï¼Œè¿›è€Œè°ƒç”¨äº†hotApplyã€‚hotApplyæ ¹æ®æ¨¡å—IDæ‰¾åˆ°æ—§æ¨¡å—ç„¶åå°†å®ƒåˆ é™¤ï¼Œç„¶åæ‰§è¡Œçˆ¶æ¨¡å—ä¸­æ³¨å†Œçš„acceptå›è°ƒï¼Œä»è€Œå®ç°æ¨¡å—å†…å®¹çš„å±€éƒ¨æ›´æ–°ã€‚ æ€è€ƒğŸ’¡ï¼šwebpack å¯ä»¥å°†ä¸åŒçš„æ¨¡å—æ‰“åŒ…æˆ bundle æ–‡ä»¶æˆ–è€…å‡ ä¸ª chunk æ–‡ä»¶ï¼Œä½†æ˜¯å½“æˆ‘é€šè¿‡ webpack HMR è¿›è¡Œå¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å¹¶æ²¡æœ‰åœ¨æˆ‘çš„ dist ç›®å½•ä¸­æ‰¾åˆ° webpack æ‰“åŒ…å¥½çš„æ–‡ä»¶ï¼Œå®ƒä»¬å»å“ªå‘¢ï¼Ÿ åŸæ¥ webpack å°† bundle.js æ–‡ä»¶æ‰“åŒ…åˆ°äº†å†…å­˜ä¸­ï¼Œä¸ç”Ÿæˆæ–‡ä»¶çš„åŸå› å°±åœ¨äºè®¿é—®å†…å­˜ä¸­çš„ä»£ç æ¯”è®¿é—®æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶æ›´å¿«ï¼Œè€Œä¸”ä¹Ÿå‡å°‘äº†ä»£ç å†™å…¥æ–‡ä»¶çš„å¼€é”€ï¼Œè¿™ä¸€åˆ‡éƒ½å½’åŠŸäºmemory-fsï¼Œmemory-fs æ˜¯ webpack-dev-middleware çš„ä¸€ä¸ªä¾èµ–åº“ï¼Œwebpack-dev-middleware å°† webpack åŸæœ¬çš„ outputFileSystem æ›¿æ¢æˆäº†MemoryFileSystem å®ä¾‹ï¼Œè¿™æ ·ä»£ç å°±å°†è¾“å‡ºåˆ°å†…å­˜ä¸­ã€‚ æ€è€ƒğŸ’¡ï¼šé€šè¿‡æŸ¥çœ‹ webpack-dev-server çš„ package.json æ–‡ä»¶ï¼Œæˆ‘ä»¬çŸ¥é“å…¶ä¾èµ–äº webpack-dev-middleware åº“ï¼Œé‚£ä¹ˆ webpack-dev-middleware åœ¨ HMR è¿‡ç¨‹ä¸­æ‰®æ¼”ä»€ä¹ˆè§’è‰²ï¼Ÿ webpack-dev-middlewareæ‰®æ¼”æ˜¯ä¸­é—´ä»¶çš„è§’è‰²ï¼Œä¸€å¤´å¯ä»¥è°ƒç”¨webpackæš´éœ²çš„APIæ£€æµ‹ä»£ç çš„å˜åŒ–ï¼Œä¸€å¤´å¯ä»¥é€šè¿‡sockjså’Œwebpack-dev-server/clientå»ºç«‹webSocketé•¿è¿æ¥ï¼Œå°†webapckæ‰“åŒ…ç¼–è¯‘çš„å„ä¸ªé˜¶æ®µå‘é€ç»™æµè§ˆå™¨ç«¯ã€‚ æ€è€ƒğŸ’¡ï¼šä½¿ç”¨ HMR çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ Chrome å¼€å‘è€…å·¥å…·æˆ‘çŸ¥é“æµè§ˆå™¨æ˜¯é€šè¿‡ websocket å’Œ webpack-dev-server è¿›è¡Œé€šä¿¡çš„ï¼Œä½†æ˜¯ websocket çš„ message ä¸­å¹¶æ²¡æœ‰å‘ç°æ–°æ¨¡å—ä»£ç ã€‚æ‰“åŒ…åçš„æ–°æ¨¡å—åˆæ˜¯é€šè¿‡ä»€ä¹ˆæ–¹å¼å‘é€åˆ°æµè§ˆå™¨ç«¯çš„å‘¢ï¼Ÿä¸ºä»€ä¹ˆæ–°çš„æ¨¡å—ä¸é€šè¿‡ websocket éšæ¶ˆæ¯ä¸€èµ·å‘é€åˆ°æµè§ˆå™¨ç«¯å‘¢ï¼Ÿ åŠŸèƒ½å—çš„è§£è€¦ï¼Œå„ä¸ªæ¨¡å—å„å¸å…¶èŒï¼Œdev-server/client åªè´Ÿè´£æ¶ˆæ¯çš„ä¼ é€’è€Œä¸è´Ÿè´£æ–°æ¨¡å—çš„è·å–ï¼Œè€Œè¿™äº›å·¥ä½œåº”è¯¥æœ‰ HMR runtime æ¥å®Œæˆï¼ŒHMR runtime æ‰åº”è¯¥æ˜¯è·å–æ–°ä»£ç çš„åœ°æ–¹ã€‚å†å°±æ˜¯å› ä¸ºä¸ä½¿ç”¨ webpack-dev-server çš„å‰æï¼Œä½¿ç”¨ webpack-hot-middleware å’Œ webpack é…åˆä¹Ÿå¯ä»¥å®Œæˆæ¨¡å—çƒ­æ›´æ–°æµç¨‹ï¼Œåœ¨ä½¿ç”¨ webpack-hot-middleware ä¸­æœ‰ä»¶æœ‰æ„æ€çš„äº‹ï¼Œå®ƒæ²¡æœ‰ä½¿ç”¨ websocketï¼Œè€Œæ˜¯ä½¿ç”¨çš„ EventSourceã€‚ç»¼ä¸Šæ‰€è¿°ï¼ŒHMR çš„å·¥ä½œæµä¸­ï¼Œä¸åº”è¯¥æŠŠæ–°æ¨¡å—ä»£ç æ”¾åœ¨ websocket æ¶ˆæ¯ä¸­ã€‚ æ€è€ƒğŸ’¡ï¼šæµè§ˆå™¨æ‹¿åˆ°æœ€æ–°çš„æ¨¡å—ä»£ç ï¼ŒHMR åˆæ˜¯æ€ä¹ˆå°†è€çš„æ¨¡å—æ›¿æ¢æˆæ–°çš„æ¨¡å—ï¼Œåœ¨æ›¿æ¢çš„è¿‡ç¨‹ä¸­æ€æ ·å¤„ç†æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Ÿ æ€è€ƒğŸ’¡ï¼šå½“æ¨¡å—çš„çƒ­æ›¿æ¢è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ›¿æ¢æ¨¡å—å¤±è´¥ï¼Œæœ‰ä»€ä¹ˆå›é€€æœºåˆ¶å—ï¼Ÿ æ¨¡å—çƒ­æ›´æ–°çš„é”™è¯¯å¤„ç†ï¼Œå¦‚æœåœ¨çƒ­æ›´æ–°è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œçƒ­æ›´æ–°å°†å›é€€åˆ°åˆ·æ–°æµè§ˆå™¨ é¢è¯•é¢˜ï¼šè¯´ä¸€ä¸‹webpackçš„çƒ­æ›´æ–°åŸç†ï¼Ÿ webpacké€šè¿‡watchå¯ä»¥ç›‘æµ‹ä»£ç çš„å˜åŒ–ï¼›webpack-dev-middlewareå¯ä»¥è°ƒç”¨webpackæš´éœ²çš„APIæ£€æµ‹ä»£ç å˜åŒ–ï¼Œå¹¶ä¸”å‘Šè¯‰webpackå°†ä»£ç ä¿å­˜åˆ°å†…å­˜ä¸­ï¼›webpack-dev-middlewareé€šè¿‡sockjså’Œwebpack-dev-server/clientå»ºç«‹webSocketé•¿è¿æ¥ï¼Œå°†webpackæ‰“åŒ…é˜¶æ®µçš„å„ä¸ªçŠ¶æ€å‘ŠçŸ¥æµè§ˆå™¨ç«¯ï¼Œæœ€é‡è¦çš„æ˜¯æ–°æ¨¡å—çš„hashå€¼ã€‚webpack-dev-server/clienté€šè¿‡webpack/hot/dev-serverä¸­çš„HMRå»è¯·æ±‚æ–°çš„æ›´æ–°æ¨¡å—ï¼ŒHMRä¸»è¦å€ŸåŠ©JSONPã€‚å…ˆæ‹¿åˆ°hashçš„jsonæ–‡ä»¶ï¼Œç„¶åæ ¹æ®hashæ‹¼æ¥å‡ºæ›´æ–°çš„æ–‡ä»¶jsï¼Œç„¶åHotModulePluginå¯¹æ¯”æ–°æ—§æ¨¡å—å’Œæ¨¡å—ä¾èµ–å®Œæˆæ›´æ–°ã€‚</p><h2 id="webpackçš„hashç±»å‹" tabindex="-1"><a class="header-anchor" href="#webpackçš„hashç±»å‹"><span>webpackçš„Hashç±»å‹</span></a></h2><h3 id="hash" tabindex="-1"><a class="header-anchor" href="#hash"><span>[hash]</span></a></h3><p>æè¿°ï¼šæ•´ä¸ªé¡¹ç›®æ„å»ºçš„å“ˆå¸Œå€¼ï¼Œæ¯æ¬¡æ„å»ºæ—¶ç”Ÿæˆä¸€ä¸ªæ–°çš„å“ˆå¸Œå€¼ã€‚ é€‚ç”¨åœºæ™¯ï¼šé€‚ç”¨äºæ•´ä¸ªé¡¹ç›®æ„å»ºçš„å…¨å±€å“ˆå¸Œï¼Œé€šå¸¸ç”¨äºéä»£ç èµ„æºï¼ˆå¦‚ CSSã€å›¾åƒç­‰ï¼‰ã€‚</p><h3 id="chunkhash" tabindex="-1"><a class="header-anchor" href="#chunkhash"><span>[chunkhash]</span></a></h3><p>æè¿°ï¼šåŸºäºæ¯ä¸ªå…¥å£æ–‡ä»¶åŠå…¶ä¾èµ–çš„å“ˆå¸Œå€¼ï¼Œä¸åŒçš„å…¥å£æ–‡ä»¶ä¼šç”Ÿæˆä¸åŒçš„å“ˆå¸Œå€¼ã€‚ é€‚ç”¨åœºæ™¯ï¼šé€‚ç”¨äºä»£ç åˆ†å‰²åçš„æ–‡ä»¶ï¼Œç¡®ä¿åªæœ‰å†…å®¹å˜åŒ–çš„æ–‡ä»¶ä¼šç”Ÿæˆæ–°çš„å“ˆå¸Œå€¼ï¼Œä»è€Œæ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜ã€‚</p><h3 id="contenhash" tabindex="-1"><a class="header-anchor" href="#contenhash"><span>[contenhash]</span></a></h3><p>æè¿°ï¼šåŸºäºæ–‡ä»¶å†…å®¹çš„å“ˆå¸Œå€¼ï¼Œæ–‡ä»¶å†…å®¹ä¸å˜åˆ™å“ˆå¸Œå€¼ä¸å˜ã€‚ é€‚ç”¨åœºæ™¯ï¼šé€‚ç”¨äºé™æ€èµ„æºæ–‡ä»¶ï¼ˆå¦‚ CSSã€å›¾ç‰‡ç­‰ï¼‰ï¼Œç¡®ä¿æ–‡ä»¶å†…å®¹ä¸å˜æ—¶å“ˆå¸Œå€¼ä¹Ÿä¸å˜ï¼Œä»è€Œæ›´å¥½åœ°åˆ©ç”¨ç¼“å­˜ã€‚</p><h2 id="tree-shaking" tabindex="-1"><a class="header-anchor" href="#tree-shaking"><span>Tree Shaking</span></a></h2><p>é…ç½®mode=productioné»˜è®¤æ”¯æŒtree shakingï¼Œå¹¶ä¸”package.jsonè®¾ç½®sideEffectsï¼Œè®¾ç½®çš„æ–‡ä»¶è¡¨æ˜ä¸æ”¯æŒtree shaking</p><p>å¯åŠ¨Tree ShakingåŠŸèƒ½å¿…é¡»åŒæ—¶æ»¡è¶³ä»¥ä¸‹3ä¸ªæ¡ä»¶ï¼š 1.ä½¿ç”¨ESMè§„èŒƒç¼–å†™æ¨¡å—ä»£ç  2.é…ç½®optimization.usedExportsä¸ºtrue,å¯åŠ¨æ ‡è®°åŠŸèƒ½ 3.å¯åŠ¨ä»£ç ä¼˜åŒ–åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼å®ç°ï¼š *é…ç½®optimization.minimize=true *æä¾›optimization.minimizeræ•°ç»„</p><pre><code class="language-js"><span class="token comment">// webpack.config.js</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;terser-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;bundle.js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&#39;babel-loader&#39;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;@babel/preset-env&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;modules&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// ç¡®ä¿Babelä¸ä¼šå°†ES6æ¨¡å—è¯­æ³•è½¬æ¢ä¸ºCommonJSæ¨¡å—</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// è¿™è¡Œæ˜¯å¯é€‰çš„ï¼Œç”Ÿäº§æ¨¡å¼ä¸‹é»˜è®¤å¯ç”¨</span>
    <span class="token literal-property property">minimize</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">terserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">compress</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">dead_code</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token literal-property property">drop_console</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre><h2 id="tree-shakingåŸç†" tabindex="-1"><a class="header-anchor" href="#tree-shakingåŸç†"><span>Tree ShakingåŸç†</span></a></h2><h2 id="vendor-commonæ–‡ä»¶ä»£è¡¨ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#vendor-commonæ–‡ä»¶ä»£è¡¨ä»€ä¹ˆ"><span>vendor &amp;&amp; commonæ–‡ä»¶ä»£è¡¨ä»€ä¹ˆ</span></a></h2><p>vendoræ–‡ä»¶é€šå¸¸æ˜¯æŒ‡ç¬¬ä¸‰æ–¹åº“å’Œä¾èµ–é¡¹ï¼Œä¾‹å¦‚Reactã€Lodashã€Moment.jsç­‰ã€‚è¿™äº›åº“é€šå¸¸ä¸ä¼šé¢‘ç¹å˜åŒ–ï¼Œå› æ­¤å°†å®ƒä»¬æ‰“åŒ…åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­å¯ä»¥åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ï¼Œä»è€Œå‡å°‘åŠ è½½æ—¶é—´ commonæ–‡ä»¶é€šå¸¸æ˜¯æŒ‡é¡¹ç›®ä¸­å¤šä¸ªå…¥å£ç‚¹ä¹‹é—´å…±äº«çš„ä»£ç ã€‚è¿™äº›ä»£ç å¯èƒ½æ˜¯ä¸šåŠ¡é€»è¾‘ã€å·¥å…·å‡½æ•°ç­‰ã€‚å°†è¿™äº›å…±äº«ä»£ç æå–åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é¿å…é‡å¤åŠ è½½ï¼Œæé«˜ä»£ç å¤ç”¨æ€§å’ŒåŠ è½½æ•ˆç‡</p><pre><code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].[contenthash].js&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// é…ç½®ä»£ç æ‹†åˆ†</span>
      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token comment">// å¯¹æ‰€æœ‰ç±»å‹çš„ä»£ç å—è¿›è¡Œæ‹†åˆ†</span>
      <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// å®šä¹‰ç¼“å­˜å€¼</span>
        <span class="token literal-property property">vendor</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// å°†æ‰€æœ‰æ¥è‡ªnode_modulesä¸‹çš„æ¨¡å—æ‰“åŒ…åˆ°vendorsæ–‡ä»¶</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]node_modules[\\\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;vendors&#39;</span><span class="token punctuation">,</span> <span class="token comment">// vendors.[contenthash].js</span>
          <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token literal-property property">common</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// å°†æ‰€æœ‰æ¥è‡ªcommonä¸‹çš„æ¨¡å—æ‰“åŒ…åˆ°vendorsæ–‡ä»¶</span>
          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]src[\\\\/]common[\\\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
          <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;common&#39;</span><span class="token punctuation">,</span> <span class="token comment">// common.[contenthash].js </span>
          <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> 
          <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token comment">// å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><h2 id="source-mapæœ‰å“ªäº›å€¼" tabindex="-1"><a class="header-anchor" href="#source-mapæœ‰å“ªäº›å€¼"><span>source-mapæœ‰å“ªäº›å€¼</span></a></h2><h2 id="å‚è€ƒ" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒ"><span>å‚è€ƒ</span></a></h2>`,24),i={href:"https://juejin.cn/post/7152845665477869582?searchId=202407171441107B631F6471FADB26ED99",target:"_blank",rel:"noopener noreferrer"},u={href:"https://juejin.cn/post/7300118821531942927?searchId=202407171419393CEE50881EE03D040614",target:"_blank",rel:"noopener noreferrer"};function h(d,m){const a=t("ExternalLinkIcon");return o(),r("div",null,[k,n("p",null,[n("a",i,[s("webpackçƒ­æ›´æ–°åŸç†"),e(a)]),n("a",u,[s("ä¸€æ–‡äº†è§£Webpackçƒ­æ›´æ–°(HMR)åŸç†"),e(a)])])])}const w=p(l,[["render",h],["__file","webpack.html.vue"]]),g=JSON.parse('{"path":"/blogs/technology/kuangjia/webpack.html","title":"webpack","lang":"en-US","frontmatter":{"title":"webpack","date":"2024/07/02","tags":["æ¡†æ¶"],"categories":["æ¡†æ¶"]},"headers":[{"level":2,"title":"webpack5.0ä¼˜åŒ–ç‚¹","slug":"webpack5-0ä¼˜åŒ–ç‚¹","link":"#webpack5-0ä¼˜åŒ–ç‚¹","children":[]},{"level":2,"title":"Hot Module Replacement(HMR)","slug":"hot-module-replacement-hmr","link":"#hot-module-replacement-hmr","children":[{"level":3,"title":"ä¸ºä»€ä¹ˆéœ€è¦çƒ­æ›´æ–°ï¼Ÿ","slug":"ä¸ºä»€ä¹ˆéœ€è¦çƒ­æ›´æ–°","link":"#ä¸ºä»€ä¹ˆéœ€è¦çƒ­æ›´æ–°","children":[]},{"level":3,"title":"HMRæ˜¯æ€æ ·å®ç°è‡ªåŠ¨ç¼–è¯‘çš„ï¼Ÿ","slug":"hmræ˜¯æ€æ ·å®ç°è‡ªåŠ¨ç¼–è¯‘çš„","link":"#hmræ˜¯æ€æ ·å®ç°è‡ªåŠ¨ç¼–è¯‘çš„","children":[]}]},{"level":2,"title":"webpackçš„Hashç±»å‹","slug":"webpackçš„hashç±»å‹","link":"#webpackçš„hashç±»å‹","children":[{"level":3,"title":"[hash]","slug":"hash","link":"#hash","children":[]},{"level":3,"title":"[chunkhash]","slug":"chunkhash","link":"#chunkhash","children":[]},{"level":3,"title":"[contenhash]","slug":"contenhash","link":"#contenhash","children":[]}]},{"level":2,"title":"Tree Shaking","slug":"tree-shaking","link":"#tree-shaking","children":[]},{"level":2,"title":"Tree ShakingåŸç†","slug":"tree-shakingåŸç†","link":"#tree-shakingåŸç†","children":[]},{"level":2,"title":"vendor && commonæ–‡ä»¶ä»£è¡¨ä»€ä¹ˆ","slug":"vendor-commonæ–‡ä»¶ä»£è¡¨ä»€ä¹ˆ","link":"#vendor-commonæ–‡ä»¶ä»£è¡¨ä»€ä¹ˆ","children":[]},{"level":2,"title":"source-mapæœ‰å“ªäº›å€¼","slug":"source-mapæœ‰å“ªäº›å€¼","link":"#source-mapæœ‰å“ªäº›å€¼","children":[]},{"level":2,"title":"å‚è€ƒ","slug":"å‚è€ƒ","link":"#å‚è€ƒ","children":[]}],"git":{"createdTime":1721214190000,"updatedTime":1725353590000,"contributors":[{"name":"zhuxiaoying","email":"zhuxiaoying@meituan.com","commits":4}]},"filePathRelative":"blogs/technology/æ¡†æ¶/webpack.md"}');export{w as comp,g as data};
