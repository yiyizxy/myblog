---
title: 小程序和H5的区别
date: 2024/09/04
tags:
 - 框架
categories:
 - 框架
---

## 运行环境

小程序是直接运行在特定APP中的一个独立的运行环境（如支付宝、微信），H5运行在各种浏览器，这些浏览器都遵循相同的web标准

## 开发环境

小程序依赖官方提供的IDE（如微信、支付宝），只能用官方提供的api和组件，H5可以根据自己的喜好选择不同的开发工具，另外H5的库也非常丰富，开发自由度比较高

## 性能和体验

小程序由于是运行在一个相对封闭且优化的环境中，所以性能较好，并且可以实现部分原生APP体验（如离线访问、深度集成），H5则受到浏览器限制，相比较小程序，性能略差

### 热启动

如果用户离开页面或者切换到其他应用，再回来可以热启动，H5没有，你关闭页面后生命周期就结束了，需要重新打开

### 离线访问

小程序在首次打开的时候会下载对应的代码和资源到本地，所以即使在没有网络的情况下，也可以体验部分功能，H5每次打开都需要从服务器获取页面和资源，没有网络的情况下无法访问页面

### 深度集成（系统权限）

小程序是直接运行在APP内的，可以更深入的集成到APP的生态系统中，例如微信小程序的登录、分享、支付功能等，H5只能调用浏览器提供的标准WEB API

## 更新机制

小程序发版后需要重新打开小程序才会更新，另外小程序有个最大的优点是支持增量更新，只下载变更部分的代码，减少下载时间和流量消耗，该能力取决于平台是否支持，H5是用户重新刷新页面就能更新资源，比较方便，缺点是无法做到增量更新

增量更新如何实现：当小程序开发者发布新版本时，小程序平台会比较新旧两个版本的差异，并生成一个包含差异信息的补丁文件。然后，当用户打开小程序时，小程序平台会检查用户设备上的小程序版本。如果发现用户的版本落后于服务器上的版本，那么就会下载补丁文件，而不是整个新版本的代码包。接着，小程序平台会应用补丁文件，将用户设备上的小程序更新到新版本。

这种增量更新的方式可以大大减少需要下载的数据量，从而提高更新速度，节省用户的网络流量。此外，因为补且文件只包含差异信息，所以它通常比完整的代码包要小得多，这使得小程序可以更快地启动和运行。

## 渲染机制

小程序不存在DOM，一些依赖DOM操作的包无法使用，小程序是双线程架构，渲染和逻辑在不同的线程，分别在WebView 线程和 JavaScriptCore 线程中运行，逻辑层运行在 JavaScriptCore 中，负责数据处理和事件处理等逻辑，而渲染层则运行在 WebView 中，负责页面的渲染。这两个线程通过一个数据桥进行通信，JS线程将需要渲染的数据发送到渲染线程，然后由渲染线程根据这些数据来渲染页面。由于小程序的渲染过程并不依赖于JS，因此即使JS线程发生阻塞，页面的渲染也不会受到影响。这种机制有利于提高渲染效率，减少卡顿，提升用户体验。小程序由于不支持直接操作DOM，因此所有的页面更新都是通过数据驱动的，这使得代码更为简洁，易于维护。H5的渲染和逻辑都在一个主线程内运行，H5则使用的是传统的浏览器渲染机制。当页面的数据或状态发生变化时，JavaScript 会直接操作 DOM，修改页面的内容。浏览器会监听这些操作，当 DOM 发生变化时，会重新计算样式，生成新的布局，然后绘制到屏幕上。这种方式的优点是灵活，可以实现各种复杂的效果和交互，但是缺点是性能开销比较大，如果操作不当，可能会导致页面卡顿或闪烁。

## 开发成本

学习成本上，小程序的开发完全依赖官方提供的api和组件等，学习成本较H5高。兼容性开发上，小程序不需要考虑手机尺寸型号等等，可能需要针对不同平台去做适配，相比较h5，开发成本略小

## 参考

[小程序与H5深度对比及原理解析](https://juejin.cn/post/7239336033367277629?searchId=202403251501226392B9EF59D62C182963)

